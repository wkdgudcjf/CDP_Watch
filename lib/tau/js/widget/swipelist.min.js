/*
  * Copyright (c) 2013 Samsung Electronics Co., Ltd
  *
  * Licensed under the Flora License, Version 1.1 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *     http://floralicense.org/license/
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

!function(a){var b=tau;!function(a,b,c){if(!a.Swipelist){var d={LEFT:"swipelist.left",RIGHT:"swipelist.right"},e=function(a,b){return this._create(a,b),this};e.prototype={_create:function(a,b){var d;this.listElement=a,d=this._findActivePage(this.listElement),this.contentElement=b.scrollableElement?b.scrollableElement:this._findScrollableElement(this.listElement),this.swipelistElement=d.getElementsByClassName("ui-swipelist")[0],this.leftElement=b.left?d.getElementsByClassName("ui-swipelist-left")[0]:c,this.rightElement=b.right?d.getElementsByClassName("ui-swipelist-right")[0]:c,this.activeElement=null,this.activeTarget=null,this.startX=0,this.options={},this._interval=0,this._cancelled=!1,this._dragging=!1,this._animating=!1,this.swipelistElementStyle=this.swipelistElement?this.swipelistElement.style:c,this.leftElementStyle=this.leftElement?this.leftElement.style:c,this.rightElementStyle=this.rightElement?this.rightElement.style:c,this._initOptions(b),this._init(),this._bindEvents()},_init:function(){this.swipelistElement&&(this.swipelistElementStyle.display="none",this.swipelistElementStyle.background="transparent",this.swipelistElementStyle.width=b.innerWidth+"px",this.swipelistElementStyle.height=b.innerHeight+"px"),this.leftElementStyle&&(this.leftElementStyle.display="none",this.leftElementStyle.background="-webkit-linear-gradient(left, "+this.options.ltrStartColor+" 0%, "+this.options.ltrEndColor+" 0%)"),this.rightElementStyle&&(this.rightElementStyle.display="none",this.rightElementStyle.background="-webkit-linear-gradient(right, "+this.options.rtlStartColor+" 0%, "+this.options.rtlEndColor+" 0%)")},_initOptions:function(a){this.options={threshold:30,animationThreshold:150,animationDuration:200,animationInterval:8,ltrStartColor:"#62a917",ltrEndColor:"#58493a",rtlStartColor:"#eaa317",rtlEndColor:"#58493a"},this.setOptions(a)},_findActivePage:function(a){for(;a&&!a.className.match("ui-page-active");)a=a.parentNode;return a},_findScrollableElement:function(a){for(;!(a.scrollHeight>a.offsetHeight||a.scrollWidth>a.offsetWidth);)a=a.parentNode;return a},setOptions:function(b){a.extendObject(this.options,b)},_bindEvents:function(){"ontouchstart"in b?(this.listElement.addEventListener("touchstart",this),this.listElement.parentNode.addEventListener("touchmove",this),this.listElement.parentNode.addEventListener("touchend",this)):(this.listElement.addEventListener("mousedown",this),this.listElement.parentNode.addEventListener("mousemove",this),this.listElement.parentNode.addEventListener("mouseup",this)),this.contentElement.addEventListener("scroll",this),document.addEventListener("touchcancel",this)},_unbindEvents:function(){"ontouchstart"in b?(this.listElement.removeEventListener("touchstart",this),this.listElement.removeEventListener("touchmove",this),this.listElement.removeEventListener("touchend",this)):(this.listElement.removeEventListener("mousedown",this),this.listElement.removeEventListener("mousemove",this),this.listElement.removeEventListener("mouseup",this)),this.contentElement.removeEventListener("scroll",this),document.removeEventListener("touchcancel",this)},handleEvent:function(a){var b=this._getPointPositionFromEvent(a);switch(a.type){case"mousedown":case"touchstart":this._start(a,b);break;case"mousemove":case"touchmove":this._move(a,b),this._preventScroll(a);break;case"mouseup":case"touchend":this._end(a);break;case"touchcancel":case"scroll":this._cancel()}},_getPointPositionFromEvent:function(a){var b=1;return"touchend"===a.type&&(b=0),this._multitouch=a.touches&&a.touches.length>b?!0:!1,-1!==a.type.search(/^touch/)&&a.touches&&a.touches.length?{x:a.touches[0].clientX,y:a.touches[0].clientY}:{x:a.clientX,y:a.clientY}},_translate:function(a,c,d){var e,f,g,h=c/b.innerWidth*100,i=this;this.options.left&&c>0?(e=i.options.ltrStartColor,f=i.options.ltrEndColor,g="left"):this.options.right&&0>c&&(e=i.options.rtlStartColor,f=i.options.rtlEndColor,g="right",h=Math.abs(h)),function j(){a.background="-webkit-linear-gradient("+g+", "+e+" 0%, "+f+" "+h+"%)",d&&h<=i.options.animationDuration?(i._animating=!0,h+=i.options.animationInterval,b.webkitRequestAnimationFrame(j)):d&&h>=i.options.animationDuration&&(i._animating=!1,i._transitionEnd())}()},_fireEvent:function(b,c){a.fireEvent(this.listElement,b,c)},_start:function(a,b){var c,d;this._dragging=!1,this._cancelled=!1,this.activeTarget=a.target,c=this.activeTarget.offsetWidth+"px",d=this.activeTarget.offsetHeight+"px",this.activeTarget&&(this.options.left&&(this.leftElementStyle.width=c,this.leftElementStyle.height=d),this.options.right&&(this.rightElementStyle.width=c,this.rightElementStyle.height=d),this.startX=b.x,this.startY=b.y,this._dragging=!0)},_move:function(a,b){var c,d;this._dragging&&!this._cancelled&&(this._interval=b.x-this.startX,this.options.left&&this._interval>0?(this.options.right&&(this.rightElementStyle.display="none"),this.activeElement=this.leftElement,c=this.leftElementStyle,d=this._interval):this.options.right&&this._interval<0&&(this.options.left&&(this.leftElementStyle.display="none"),this.activeElement=this.rightElement,c=this.rightElementStyle,d=this._interval),Math.abs(this._interval)>this.options.threshold&&(c.top=this.activeTarget.offsetTop-this.contentElement.scrollTop+"px",c.display="block",this.swipelistElementStyle.display="block",this._translate(c,d,!1),a.preventDefault()))},_end:function(a){return a.target!==this.activeTarget?(a.preventDefault(),void 0):(this._dragging&&!this._cancelled&&(this.options.left&&this._interval>this.options.animationThreshold?this._fire(d.LEFT):this.options.right&&this._interval<-this.options.animationThreshold?this._fire(d.RIGHT):this._hide(),this._dragging=!1),void 0)},_fire:function(a){a===d.LEFT?this._translate(this.leftElementStyle,this._interval,!0):a===d.RIGHT&&this._translate(this.rightElementStyle,this._interval,!0)},_transitionEnd:function(){this._hide(),this.options.left&&this.activeElement===this.leftElement?this._fireEvent(d.LEFT):this.options.right&&this.activeElement===this.rightElement&&this._fireEvent(d.RIGHT)},_preventScroll:function(a){this._animating&&a.preventDefault()},_cancel:function(){this._dragging=!1,this._cancelled=!0,this._hide()},_hide:function(){this.swipelistElementStyle.display="none",this.activeElement.style.display="none"},destroy:function(){this._unbindEvents(),this.contentElement=null,this.swipelistElement=null,this.listElement=null,this.leftElement=null,this.rightElement=null,this.activeElement=null,this.activeTarget=null,this.swipelistElementStyle=null,this.leftElementStyle=null,this.rightElementStyle=null,this.startX=null,this.options=null,this.gesture=null,this._cancelled=null,this._dragging=null,this._animating=null}},a.SwipeList=e}}(b,a)}(this);